#!/bin/bash
####################################################################
# Prey System Module Windows Functions - by Carlos Yaconi H.
# URL: http://preyproject.com
# License: GPLv3
####################################################################

##This function MUST be called first, since it grabs windows information to be used by the other functions
get_os_info(){
	win_info=`systeminfo`
	os_version=`echo "$win_info" | grep "OS Name" | sed 's/.*: *\(.*\)/\1/'`
	kernel_version=`echo "$win_info" | grep "^OS Version" | sed 's/.*: *\(.*\)/\1/'`
	
	echo -e "OS: $os_version \nVersion: $kernel_version"
	
	
}       
get_cpu_info(){
	#cpu_name - cpu_speed - cpu_number - cpu_cores  
	cpu_name=`echo "$win_info" | grep "Processor(s)" -A1 | tail -1 | sed 's/.*\[.*\]: \(.*\)/\1/'`
	cpu_speed=`echo "$win_info"  | grep "Processor(s)" -A1 | tail -1 | sed 's/.*\[.*\]:.*~\(.*\)/\1/'`
	cpu_number=`echo "$win_info" | grep "Processor(s)" | sed 's/.*: *\([0-9]\) .*/\1/'`
	#cpu_cores=""
	
	echo -e "CPU info:\n- Name: $cpu_name\n- Speed: $cpu_speed\n- Number of CPUs: $cpu_number\n- Number of cores: $cpu_cores"
}

get_memory_info(){
	
	mem_info=`echo "$win_info"	| grep "Total Physical Memory" | sed 's/.*: \(.*\)/\1/'`
	echo -e "Memory info:\n $mem_info"
	
}

#get_sata_info(){
#	sata_info=`system_profiler SPSerialATADataType | awk 'BEGIN { 
#	UNIT = 0
#	ORS = "#"}
#
#	/Vendor/ { UNIT+=1 ; print UNIT"_Vendor="$2 ; cap=0}
#	/Model: /{ print UNIT"_Model="$2" "$3 }
#	/Capacity: / && cap==0 { print UNIT"_Capacity="$2$3 ; cap=1}'`
#	
#	echo -e "SATA info:\n $sata_info"
#} 
#
#get_system_ids(){
#	serial_number=`echo "$hw_info" | grep "System Model" | sed 's/.*: \(.*\)/\1/'`
#}
#