#!/bin/bash
####################################################################
# Prey Session Module - by Tomas Pollak (bootlog.org)
# URL : http://preyproject.com
# License: GPLv3
####################################################################

echo " -- Getting current logged in user name..."
add_trace logged_user $logged_user

echo "$STRING_UPTIME_AND_PROCESS"
get_uptime
add_trace uptime "$uptime"
get_running_programs
add_trace running_programs "$running_programs"

if [ "$session__get_modified_files" == 'y' ]; then
	echo "$STRING_MODIFIED_FILES"
	get_modified_files
	if [ -n "$modified_files" ]; then
		add_trace modified_files "$modified_files"
	else
		echo ' !! Nothing found. Make sure you type in a valid path.'
	fi
fi

if [ "$session__get_active_connections" == 'y' ]; then
	echo "$STRING_ACTIVE_CONNECTIONS"
	get_active_connections
	add_trace active_connections "$active_connections"
fi

if [ "$session__get_screenshot" == 'y' ]; then
	echo "$STRING_GET_SCREENSHOT"
	get_screenshot

	if [ -f "$session__screenshot" ]; then
		add_file screenshot "$session__screenshot"
	fi
fi
