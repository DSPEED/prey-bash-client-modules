#!/bin/bash
####################################################################
# Prey Session Module Mac Functions - by Tomas Pollak (bootlog.org)
# URL: http://preyproject.com
# License: GPLv3
####################################################################

get_active_connections() {
	active_connections=`netstat -p tcp -a`
}

get_screenshot() {
	local screencapture='/usr/sbin/screencapture -mx'

	if [ "`whoami`" == "root" ]; then # we need to get the PID of the loginwindow and take the screenshot through launchctl
		launchctl bsexec $logged_pid $screencapture $session__screenshot
	else
		$screencapture $session__screenshot
	fi

}
