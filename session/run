#!/bin/bash
####################################################################
# Prey Session Module - by Tomas Pollak (bootlog.org)
# URL : http://preyproject.com
# License: GPLv3
####################################################################

echo " -- Get current logged in user"
add_trace logged_user $logged_user

echo "$STRING_UPTIME_AND_PROCESS"
get_uptime_and_programs
add_trace uptime "$uptime"
add_trace running_programs "$running_programs"

if [ "$get_modified_files" == 'y' ]; then
	echo "$STRING_MODIFIED_FILES"
	get_modified_files
	if [ -n "$modified_files" ]; then
		add_trace modified_files "$modified_files"
	else
		echo ' !! Nothing found. Make sure you type in a valid path.'
	fi
fi

if [ "$get_active_connections" == 'y' ]; then
	echo "$STRING_ACTIVE_CONNECTIONS"
	get_active_connections
	add_trace active_connections "$active_connections"
fi

if [ "$get_screenshot" == 'y' ]; then
	echo "$STRING_GET_SCREENSHOT"
	get_screenshot

	if [ -f "$screenshot" ]; then
		echo "$screenshot"
		add_file screenshot "$screenshot"
	else
		echo ' screenshot doesnt exist you fucking asshole'
	fi
fi
